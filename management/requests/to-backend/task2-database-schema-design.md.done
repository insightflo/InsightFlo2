# Task 2: 데이터베이스 스키마 설계 및 Supabase 연동 요청

**요청자**: PM  
**우선순위**: HIGH  
**예상 소요 시간**: 2-3일  
**Task Master ID**: 2

## 📋 작업 개요
Supabase PostgreSQL 데이터베이스 스키마를 설계하고 Next.js 백엔드와의 연동을 구성해주세요.

## 🎯 구체적 요구사항

### 1. 데이터베이스 테이블 설계
다음 테이블들을 설계하고 생성해주세요:

#### `users` 테이블
- `id` (UUID, Primary Key)
- `email` (VARCHAR, UNIQUE, NOT NULL)
- `password_hash` (VARCHAR, NOT NULL)
- `nickname` (VARCHAR)
- `created_at` (TIMESTAMP, DEFAULT NOW())

#### `news` 테이블
- `id` (UUID, Primary Key)
- `title` (VARCHAR, NOT NULL)
- `content` (TEXT)
- `summary` (TEXT)
- `sentiment` (VARCHAR) - 감정 분석 결과
- `keywords` (TEXT[]) - 키워드 배열
- `published_at` (TIMESTAMP)
- `created_at` (TIMESTAMP, DEFAULT NOW())

#### `user_keywords` 테이블
- `id` (UUID, Primary Key)
- `user_id` (UUID, Foreign Key → users.id)
- `keyword` (VARCHAR, NOT NULL)
- `weight` (INTEGER, DEFAULT 1) - 관심도 가중치
- `created_at` (TIMESTAMP, DEFAULT NOW())

#### `bookmarks` 테이블
- `id` (UUID, Primary Key)
- `user_id` (UUID, Foreign Key → users.id)
- `news_id` (UUID, Foreign Key → news.id)
- `created_at` (TIMESTAMP, DEFAULT NOW())

### 2. Supabase 프로젝트 설정
- [ ] Supabase 프로젝트 생성
- [ ] RLS (Row Level Security) 정책 설정
  - users: 본인 데이터만 접근 가능
  - user_keywords: 본인 키워드만 CRUD 가능
  - bookmarks: 본인 북마크만 CRUD 가능
  - news: 모든 사용자 READ 가능

### 3. Next.js 연동 구성
- [ ] `@supabase/supabase-js` 패키지 설치
- [ ] Supabase 클라이언트 설정 파일 생성 (`lib/supabase.ts`)
- [ ] 환경변수 설정 (`.env.local`)
  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
  - `SUPABASE_SERVICE_ROLE_KEY`

### 4. 기본 연결 테스트
- [ ] 데이터베이스 연결 확인
- [ ] 기본 CRUD 작업 테스트
- [ ] RLS 정책 동작 검증

## 📚 참고 자료
- [Supabase 공식 문서](https://supabase.com/docs)
- [Next.js with Supabase 가이드](https://supabase.com/docs/guides/getting-started/quickstarts/nextjs)

## 🔗 의존성
- Task 1 (프로젝트 초기 설정) 완료됨 ✅

## 📋 완료 기준
- [ ] 모든 테이블이 Supabase에 생성됨
- [ ] RLS 정책이 올바르게 적용됨
- [ ] Next.js에서 Supabase 클라이언트가 정상 동작함
- [ ] 기본 CRUD 테스트가 통과함

## 📝 결과물
완료 후 다음을 `.claude/contracts/interfaces/`에 문서화해주세요:
- 데이터베이스 스키마 정의서
- API 연결 설정 가이드
- 테스트 결과 리포트

## 💬 질문이나 블로커가 있다면
`.claude/responses/`에 응답 파일을 생성하거나 PM에게 직접 문의해주세요.

---
**생성일**: 2025-01-08  
**상태**: 요청됨  