# 인증 시스템 사용자 플로우 가이드

**버전**: 1.0  
**작성일**: 2025-09-09  
**작성자**: UI/UX Designer  
**관련 작업**: Task 3 (Authentication Screens Design)

## 📋 개요

InsightFlo 앱의 사용자 인증 과정에서 사용자가 경험하는 모든 플로우와 상호작용을 정의합니다. 개발팀과 QA팀이 사용자 여정을 완전히 이해하고 구현/테스트할 수 있도록 지원합니다.

## 🎯 사용자 페르소나

### 타겟 사용자
- **연령대**: 20-40대 개인 투자자
- **특징**: 스마트폰에 익숙하나 금융 앱 경험은 다양함
- **목표**: 개인화된 투자 정보 획득
- **주 사용 시간**: 출퇴근 시간, 점심시간
- **기대사항**: 빠르고 직관적인 인증 과정

## 🔄 메인 사용자 플로우

### 1. 첫 방문 사용자 플로우 (신규 가입)

```
앱 시작
    ↓
스플래시 화면 (2초)
    ↓
로그인 화면
    ↓
"계정이 없으신가요? 회원가입" 클릭
    ↓
회원가입 화면
    ↓
이메일 입력 → 실시간 중복 확인
    ↓
패스워드 입력 → 실시간 강도 체크 → 요구사항 만족 확인
    ↓
패스워드 확인 입력 → 실시간 일치 확인
    ↓
닉네임 입력 (선택사항)
    ↓
이용약관 체크박스 → 필수 동의 확인
    ↓
"회원가입" 버튼 클릭
    ↓
서버 통신 → 로딩 상태 표시
    ↓
회원가입 성공 → 환영 화면
    ↓
앱 소개 확인 → "시작하기" 클릭
    ↓
메인 앱 화면 진입
```

### 2. 기존 사용자 플로우 (로그인)

```
앱 시작
    ↓
스플래시 화면 (2초)
    ↓
로그인 화면
    ↓
이메일 입력 → 실시간 형식 검증
    ↓
패스워드 입력
    ↓
"로그인" 버튼 클릭
    ↓
서버 통신 → 로딩 상태 표시
    ↓
로그인 성공
    ↓
메인 앱 화면 직접 진입 (환영 화면 스킵)
```

## 🔍 상세 사용자 상호작용

### 회원가입 화면 상세 플로우

#### A. 이메일 입력 상호작용
```
사용자가 이메일 필드에 포커스
    ↓
키보드 표시 (이메일 타입)
    ↓
입력 중 실시간 형식 검증
    ↓
[유효한 형식] → 200ms 디바운스 후 중복 확인 API 호출
    ↓
[API 응답 대기] → 로딩 아이콘 표시
    ↓
[중복 없음] → ✅ 성공 표시 + "사용 가능한 이메일입니다"
[중복 있음] → ❌ 에러 표시 + "이미 사용 중인 이메일입니다"
    ↓
다음 필드로 자동 포커스 이동 (성공 시)
```

#### B. 패스워드 입력 상호작용
```
사용자가 패스워드 필드에 포커스
    ↓
키보드 표시 (보안 키보드)
    ↓
입력 중 실시간 강도 계산
    ↓
강도 바 업데이트 (약함→보통→좋음→강함)
    ↓
요구사항 체크리스트 실시간 업데이트:
- ✅ 8자 이상
- ✅ 영문 대소문자 포함
- ❌ 숫자 포함
- ❌ 특수문자 포함
    ↓
모든 요구사항 만족 시 → 다음 필드 활성화
```

#### C. 패스워드 확인 상호작용
```
사용자가 패스워드 확인 필드에 입력
    ↓
실시간으로 첫 번째 패스워드와 비교
    ↓
[일치] → ✅ "패스워드가 일치합니다"
[불일치] → ❌ "패스워드가 일치하지 않습니다"
    ↓
일치 시 다음 필드로 자동 포커스 이동
```

### 로그인 화면 상세 플로우

#### A. 로그인 시도 플로우
```
사용자가 "로그인" 버튼 클릭
    ↓
폼 유효성 검사
    ↓
[유효성 통과] → API 호출 시작
    ↓
버튼 로딩 상태 → "로그인 중..." + 스피너
    ↓
입력 필드 비활성화
    ↓
서버 응답 대기 (최대 10초)
    ↓
[성공] → 메인 화면 전환
[실패] → 에러 처리 플로우
```

#### B. 로그인 에러 처리 플로우
```
API 에러 응답 수신
    ↓
에러 타입 분석
    ↓
[401 인증 실패] → 토스트 메시지: "이메일 또는 패스워드를 확인해주세요"
[429 계정 잠금] → 토스트 메시지: "계정이 일시적으로 잠겼습니다"
[500 서버 오류] → 토스트 메시지: "서버 오류가 발생했습니다"
[네트워크 오류] → 전체 화면 에러: "인터넷 연결을 확인해주세요"
    ↓
버튼 로딩 상태 해제
    ↓
입력 필드 재활성화
    ↓
사용자 재시도 가능
```

## 🛠️ 에러 상황별 사용자 플로우

### 1. 네트워크 연결 실패
```
사용자 액션 (로그인/회원가입 버튼 클릭)
    ↓
네트워크 요청 실패 감지
    ↓
전체 화면 에러 화면 표시:
- 🌐 아이콘
- "인터넷 연결을 확인해주세요"
- "네트워크 연결이 불안정합니다"
- [다시 시도] 버튼
- [설정 확인] 버튼
    ↓
사용자 선택:
[다시 시도] → 동일한 요청 재실행
[설정 확인] → 시스템 설정 앱 열기
```

### 2. 서버 점검/오류 상황
```
서버 5xx 에러 발생
    ↓
토스트 메시지 표시:
- ⚠️ "서버 오류가 발생했습니다"
- "잠시 후 다시 시도해주세요"
- 5초 후 자동 사라짐
- [다시 시도] 액션 버튼
    ↓
[다시 시도] 클릭 → 동일한 요청 재실행
자동 사라짐 → 사용자가 수동으로 재시도 가능
```

### 3. 입력 유효성 실패
```
폼 제출 시 유효성 검사 실패
    ↓
실패한 필드에 포커스 이동
    ↓
해당 필드에 에러 상태 적용:
- 빨간색 테두리
- ❌ 에러 아이콘
- 구체적인 에러 메시지
    ↓
필드 흔들림 애니메이션 효과
    ↓
사용자가 올바른 값 입력 시 에러 상태 해제
```

## 📱 반응형 플로우 고려사항

### 화면 크기별 적응
```
Small Mobile (< 360px):
- 키보드 표시 시 스크롤 가능
- 입력 완료 후 자동 스크롤
- 컴포넌트 간격 축소

Tablet (768px+):
- 좌우 분할 레이아웃
- 브랜딩 영역과 폼 영역 분리
- 더 큰 터치 영역 제공
```

### 가로/세로 모드 전환
```
세로 → 가로 전환:
- 레이아웃 자동 재정렬
- 진행 중인 입력 상태 유지
- 키보드 자동 조정

가로 → 세로 전환:
- 표준 레이아웃으로 복귀
- 모든 상태 정보 유지
```

## ♿ 접근성 플로우

### 스크린 리더 사용자 플로우
```
화면 진입 → "로그인 화면" 음성 안내
    ↓
각 요소별 명확한 레이블 제공:
- "이메일 주소 입력 필드"
- "패스워드 입력 필드"  
- "로그인 버튼"
    ↓
에러 발생 시 즉시 음성 알림:
- "오류: 이메일 형식이 올바르지 않습니다"
    ↓
성공 시 피드백:
- "로그인 성공, 메인 화면으로 이동합니다"
```

### 키보드 네비게이션 플로우
```
Tab 키로 요소 간 순차 이동:
1. 이메일 입력 필드
2. 패스워드 입력 필드  
3. 패스워드 보기/숨기기 버튼
4. 로그인 버튼
5. 회원가입 링크
    ↓
Shift + Tab으로 역순 이동
    ↓
Enter 키로 버튼 활성화
Space 키로 체크박스 토글
```

## 🎯 성공/실패 메트릭스

### 성공 지표
- **회원가입 완료율**: 90% 이상
- **로그인 성공률**: 95% 이상  
- **평균 가입 소요시간**: 2분 이내
- **평균 로그인 소요시간**: 30초 이내
- **첫 번째 시도 성공률**: 85% 이상

### 실패 상황 지표
- **에러 복구율**: 80% 이상 (에러 후 재시도 성공)
- **중도 이탈률**: 15% 이하
- **패스워드 재설정 요청률**: 5% 이하

## 🧪 테스트 케이스 가이드

### 기본 플로우 테스트
1. **신규 가입 플로우**
   - 모든 필드 정상 입력 후 가입 성공
   - 환영 화면까지 완전한 여정 확인

2. **로그인 플로우**  
   - 올바른 정보로 로그인 성공
   - 메인 화면 진입 확인

### 에러 시나리오 테스트
1. **유효성 검증 에러**
   - 잘못된 이메일 형식 입력
   - 약한 패스워드 입력
   - 패스워드 불일치 입력

2. **네트워크 에러**
   - 인터넷 연결 끊김 상황
   - 서버 응답 지연 상황
   - 서버 오류 응답

3. **사용성 테스트**
   - 다양한 화면 크기에서 테스트
   - 가로/세로 모드 전환 테스트
   - 접근성 도구를 통한 테스트

## 📊 사용자 행동 분석 포인트

### 추적할 이벤트
```javascript
// Google Analytics / Firebase Analytics 이벤트
{
  // 화면 진입
  'screen_view': { screen_name: 'sign_in' },
  'screen_view': { screen_name: 'sign_up' },
  'screen_view': { screen_name: 'welcome' },
  
  // 사용자 액션
  'click': { element: 'sign_up_link' },
  'click': { element: 'sign_in_button' },
  'click': { element: 'password_toggle' },
  
  // 폼 상호작용
  'form_start': { form: 'sign_up' },
  'form_error': { field: 'email', error: 'invalid_format' },
  'form_submit': { form: 'sign_up', success: true },
  
  // 완료 이벤트
  'sign_up_complete': { method: 'email' },
  'sign_in_complete': { method: 'email' },
  'onboarding_complete': {}
}
```

### 성능 메트릭
- 화면 로딩 시간
- API 응답 시간
- 애니메이션 프레임률
- 메모리 사용량

---

**관련 문서:**
- [인증 UI 컴포넌트 스펙](authentication-ui-components.md)
- [디자인 토큰 정의서](design-tokens.md)
- [Backend API 스펙](../api-spec.md)

**테스트 도구:**
- Flutter Integration Test
- Accessibility Scanner
- Network Link Conditioner
- Device Performance Monitor